<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSë¹„ë™ê¸° : 6. fetch í”„ë¼ë¯¸ìŠ¤ ì‚¬ìš©ë²•</title>

</head>
<body>
    <p>
        <div class="exp"></div>
    </p>
    <script>
        /* 
        [ fetch í”„ë¼ë¯¸ìŠ¤ ]
        ë°ì´í„°ë¥¼ ë‹¤ë¥¸ ì„œë²„ì—ì„œ ê°€ì ¸ì˜¬ ê²½ìš° ê°™ì€ ì„œë²„ì— ìœ„ì¹˜í•œ íŒŒì¼ë³´ë‹¤ ì‹œê°„ì´ ë” ê±¸ë¦´ ìˆ˜ ìˆë‹¤!
        ì´ ë•Œ ê·¸ ì „ì†¡íŒŒì¼ì„ ì´ìš©í•œ ì²˜ë¦¬ì½”ë“œê°€ ì—ëŸ¬ë¥¼ ë‚˜íƒ€ë‚¼ í™•ë¥ ì´ ë†’ì•„ì§„ë‹¤.
        ì´ë•Œ Promiseë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ê² ë‹¤.
        ë” ì‰¬ìš´ Promiseê°€ fetch API ì´ë‹¤.
        https://www.w3schools.com/js/js_api_fetch.asp

        [ fetch APIë€ ]
        Fetch API ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì›¹ ì„œë²„ì— HTTP ìš”ì²­ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        ğŸ˜€ ë” ì´ìƒ XMLHttpRequestê°€ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

        1) ì‚¬ìš©ë²• : 
        ë³€ìˆ˜ = ì›¹ìƒíŒŒì¼ì£¼ì†Œ;

        fetch(ë³€ìˆ˜)         // ì›¹ ë¸Œë¼ìš°ì € ë°ì´í„° ë¡œë“œ
        .then(              // ë¡œë“œ í›„ ì‹¤í–‰êµ¬ì—­
            x=>x.text()     // í…ìŠ¤íŠ¸ ì½ê¸°
            )
        .then(              // í…ìŠ¤íŠ¸ ì½ì€ í›„ ì‹¤í–‰êµ¬ì—­
            y=>ëª…ë ¹ì–´ ì‚¬ìš©   // í…ìŠ¤íŠ¸ ì½ê¸°
        )

        2) ì‚¬ìš©ë²• : 
        ë³€ìˆ˜ = ì›¹ìƒíŒŒì¼ì£¼ì†Œ;

        // async í•¨ìˆ˜ ë§Œë“¤ê¸°
        async function ë¹„ë™ê¸°í•¨ìˆ˜(ë³€ìˆ˜){
            ë³€ìˆ˜1 = await fetch(ë³€ìˆ˜);  //fetchê¸°ë‹¤ë¦¼
            ë³€ìˆ˜2 = await ë³€ìˆ˜1.text(); //text()ê¸°ë‹¤ë¦¼
            í•˜ê³ ì‹¶ì€ ì½”ë“œ... // ìœ„ì˜ ì½”ë“œ ì™„ë£Œ í›„ ì‹¤í–‰
        } /////// ë¹„ë™ê¸°í•¨ìˆ˜ ///////

        // ì ì ˆí•œ ê³³ì—ì„œ ë¹„ë™ê¸°í•¨ìˆ˜ í˜¸ì¶œ
        ë¹„ë™ê¸°í•¨ìˆ˜(ë³€ìˆ˜);

         */

        const target = document.querySelector('.exp');
        // ì›¹ì— ê³µê°œ ëœ í…ìŠ¤íŠ¸ íŒŒì¼
        let file="https://tombap8.github.io/FED-RF-2023-TOM/500.%ED%95%84%EA%B8%B0%EB%AA%A8%EC%9D%8C/013.DOM%EC%9D%B4%EB%9E%80.txt";
        
        // ì¼ë°˜ì ì¸ íŒŒì¼ -> ì‹¤ì œíŒŒì¼ì€ ê°€ì ¸ì˜¤ì§€ ëª»í•¨
        // target.innerHTML = file;

        // ì›¹ ì£¼ì†Œì˜ íŒŒì¼ì„ fetchí•˜ê¸° -> ì‹¤ì œíŒŒì¼ ê°€ì ¸ì˜®
        fetch(file)
        .then(x=>x.text())
        .then(x=>target.innerHTML = x);

        let file2 = "https://tombap8.github.io/FED-PJ-2022-tom/004.JS%ED%95%99%EC%8A%B5/JS%EB%B9%84%EB%8F%99%EA%B8%B0/defaultSettings.json";

        // async í•¨ìˆ˜ ë§Œë“¤ê¸°
        async function getFile(fileData){
            myFetch = await fetch(fileData);
            myText = await myFetch.text();

            target.innerHTML += myText;
        } ///// getFile ///////
        // async í•¨ìˆ˜í˜¸ì¶œ
        getFile(file2);
        

    </script>
</body>
</html>